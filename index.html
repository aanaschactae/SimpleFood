<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzvQKAEG4MBQ6vt6texWnom_qwEzspPl2GKE5jxdk3fp8q2JQLXtKnBpa-uYgk1d_7DCA/exec";

  async function carregarConteudo() {
    const container = document.getElementById('conteudo');
    container.innerHTML = "<p>Carregando conteúdo...</p>";

    try {
      const res = await fetch(SCRIPT_URL);
      const dados = await res.json();
      container.innerHTML = '';

      dados.forEach(item => {
        const bloco = document.createElement('div');
        bloco.className = 'bloco-item';

        // título
        const titulo = document.createElement('h2');
        titulo.textContent = item.Título || '';
        bloco.appendChild(titulo);

        // descrição
        const descricao = document.createElement('p');
        descricao.textContent = item.Descrição || '';
        bloco.appendChild(descricao);

        // link + imagem separadamente
        if (item.Destino) {
          const link = document.createElement('a');
          link.href = item.Destino;
          link.target = "_blank";
          link.textContent = "Acessar conteúdo";
          bloco.appendChild(link);
        }

        if (item.Imagem) {
          const img = document.createElement('img');
          img.src = item.Imagem;
          img.alt = item.Título || 'Imagem';
          bloco.appendChild(img);
        }

        container.appendChild(bloco);
      });

    } catch (err) {
      container.innerHTML = "<p>Erro ao carregar dados: " + err.message + "</p>";
    }
  }

  carregarConteudo();
</script>
